!function(){function e(e,n,r){if(e)for(var a in e)"function"==typeof e[a]&&"function"==typeof r[a]&&i.test(e[a])?n[a]=t(e[a],r[a]):n[a]=e[a]}function t(e,t){return function(){var i=this._super;this._super=t;try{return e.apply(this,arguments)}finally{this._super=i}}}window.Class=function(){},Class.extend=function(t,i){function n(){this._init&&this._init.apply(this,arguments),this.construct&&this.construct()}var r=[];"[object Array]"=={}.toString.apply(arguments[0])&&(r=arguments[0],t=arguments[1],i=arguments[2]),n.prototype=Class.inherit(this.prototype),n.prototype.constructor=n,n.extend=Class.extend,e(i,n,this);for(var a=0;a<r.length;a++)e(r[a],n.prototype,this.prototype);return e(t,n.prototype,this.prototype),n};var i=/xyz/.test(function(){xyz})?/\b_super\b/:/./;Class.inherit=Object.create||function(e){function t(){}return t.prototype=e,new t}}();var Collections={};Collections.Collection=function(){var e=this;this.rs=[],this.add=function(t){e.rs.push(t)},this.get=function(t){return e.rs[t]},this.isEmpty=function(){return 0==e.size()},this.size=function(){return e.rs.length},this.getAll=function(){return e.rs},this.clear=function(){e.rs=[]},this.indexOf=function(t){var i=0,n=!1;return e.rs.some(function(e){var r=!0;return Object.keys(t).some(function(i){return t[i]!=e[i]?(r=!1,!0):void 0}),r?(n=!0,!0):void i++}),n?i:-1},this.removeIf=function(t){if(t){var i=e.indexOf(t);i>-1&&e.rs.splice(i,1)}},this.getIf=function(t){return e.rs[e.indexOf(t)]}};var resourceSet={audio:[],frameAnimation:[{name:"qa",duration:22,frames:[2],type:"frameAnimation",id:"4800_1462625822109"},{name:"asdf",duration:22,frames:[2],type:"frameAnimation",id:"7025_1462625883255"},{name:"ccc",duration:12,frames:[12],type:"frameAnimation",id:"3063_1462628634531"},{name:"ccc",duration:12,frames:[12],type:"frameAnimation",id:"8920_1462628638253"},{name:"fly",duration:1e3,frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],type:"frameAnimation",id:"7994_1462628924199"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,12,11,10,9,8,7,6,5,4,3,2,1],name:"fire",type:"frameAnimation",duration:1e3,id:"1074_1462655124441"},{name:"goDown",frames:[0,1,2,3],type:"frameAnimation",duration:1e3,id:"3709_1462788434049"},{name:"goLeft",frames:[4,5,6,7],type:"frameAnimation",duration:1e3,id:"5623_1462788455523"},{name:"goRight",frames:[8,9,10,11],type:"frameAnimation",duration:1e3,id:"6246_1462788475148"},{name:"goUp",frames:[12,13,14,15],type:"frameAnimation",duration:1e3,id:"8822_1462788491369"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69],name:"man2",type:"frameAnimation",duration:1e3,id:"5181_1462811068697"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],name:"rotate",duration:2e3,type:"frameAnimation",id:"6443_1462811606705"},{name:"plyPart",frames:[1,2,3],type:"frameAnimation",duration:1e3,id:"1526_1463238865434"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],name:"rotate",type:"frameAnimation",duration:1e3,id:"1524_1463239460174"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],name:"rt",type:"frameAnimation",duration:1e3,id:"1549_1463312151886_3"},{frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],name:"rt",type:"frameAnimation",duration:100,id:"5895_1463312206382_4"},{name:"fly",frames:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],type:"frameAnimation",duration:1e3,id:"5843_1463341628155_6"}],gameObject:[{spriteSheetId:"7200_1463341589577_4",width:110,height:101,name:"bird",type:"gameObject",frameAnimationIds:[],id:"6786_1463344290065_0"}],scene:[{name:"mainScene",type:"scene",gameObjectProps:[{type:"gameObject",posX:26,posY:71,protoId:"6786_1463344290065_0",id:"8822_1463345270386_32"}],id:"3227_1463345267193_31"},{name:"a2",type:"scene",gameObjectProps:[{type:"gameObject",posX:81,posY:128,protoId:"8822_1463345270386_32",id:"3644_1463347194295_1"}],id:"4442_1463347188202_0"}],spriteSheet:[{name:"bird",resourcePath:"resources/spriteSheet/bird.png",width:551,height:304,numOfFramesH:5,numOfFramesV:3,type:"spriteSheet",id:"7200_1463341589577_4"}]},Models={};Models.DataSource=null;var isPropNotFit=function(e,t){return t&&e[t]?e[t].call?!0:0==t.indexOf("_")||0==t.indexOf("$$")?!0:void 0:!0},BaseModel=Class.extend({id:null,name:"",toJsonObj:function(){var e={};for(var t in this)isPropNotFit(this,t)||(e[t]=this[t]);return e},toJsonArr:function(){var e=[];for(var t in this)isPropNotFit(this,t)||e.push({key:t,value:this[t]});return e},fromJsonObject:function(e){var t=this;Object.keys(e).forEach(function(i){i in t&&(t[i]=e[i],t[i]=+t[i]||t[i])})},clone:function(e){var t=this;return new e(t.toJsonObj())},_init:function(){arguments&&arguments[0]&&this.fromJsonObject(arguments[0])}},{dataSource:null}),Resource=BaseModel.extend({resourcePath:""});Models.SpriteSheet=Resource.extend({type:"spriteSheet",width:0,height:0,numOfFramesH:1,numOfFramesV:1,_frameWidth:0,_frameHeight:0,_numOfFrames:0,getFramePosX:function(e){return e%this.numOfFramesH*this._frameWidth},getFramePosY:function(e){return~~(e/this.numOfFramesH)*this._frameHeight},calcFrameSize:function(){this.numOfFramesH&&this.numOfFramesV&&(this._frameWidth=this.width/this.numOfFramesH,this._frameHeight=this.height/this.numOfFramesV,this._numOfFrames=this.numOfFramesH*this.numOfFramesV)},construct:function(){this.calcFrameSize()}}),Models.GameObject=BaseModel.extend({type:"gameObject",spriteSheetId:null,_spriteSheet:null,posX:0,posY:0,width:0,height:0,currFrameIndex:0,_sprPosX:0,_sprPosY:0,_frameAnimations:null,frameAnimationIds:[],_currFrameAnimation:null,construct:function(){var e=this;this._frameAnimations=new Collections.Collection,this.spriteSheetId&&(this._spriteSheet=Models.DataSource.spriteSheetList.getIf({id:this.spriteSheetId})),e._frameAnimations.clear(),this.frameAnimationIds.forEach(function(t){var i=Models.DataSource.frameAnimationList.getIf({id:t});i._gameObject=e,e._frameAnimations.add(i)})},getFrAnimation:function(e){return this._frameAnimations.getIf({name:e})},setFrameIndex:function(e){this.currFrameIndex=e,this._sprPosX=this._spriteSheet.getFramePosX(this.currFrameIndex),this._sprPosY=this._spriteSheet.getFramePosY(this.currFrameIndex)},update:function(e){this._currFrameAnimation&&this._currFrameAnimation.update(e)}}),Models.FrameAnimation=BaseModel.extend({type:"frameAnimation",name:"",frames:[],duration:1e3,_gameObject:null,_startTime:null,_timeForOneFrame:0,construct:function(){this._timeForOneFrame=~~(this.duration/this.frames.length)},play:function(){this._gameObject._currFrameAnimation=this},stop:function(){this._gameObject._currFrameAnimation=null,this._startTime=null},update:function(e){this._startTime||(this._startTime=e);var t=(e-this._startTime)%this.duration,i=~~(t/this._timeForOneFrame%this.duration);this._gameObject.currFrameIndex=this.frames[i]}}),Models.Scene=BaseModel.extend({type:"scene",gameObjectProps:[],_gameObjects:null,construct:function(){var e=this;e._gameObjects=new Collections.Collection,this.gameObjectProps.forEach(function(t){var i=Models.DataSource.gameObjectList.getIf({id:t.protoId});i.fromJsonObject(t),e._gameObjects.add(new Models.GameObject(i.clone(Models.GameObject)))})}});var DataSource={spriteSheetList:new Collections.Collection,gameObjectList:new Collections.Collection,frameAnimationList:new Collections.Collection,sceneList:new Collections.Collection},capitalize=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},toDataSource=function(e,t,i){t.forEach(function(t){i.add(new e(t))})};Models.DataSource=DataSource,["audio","spriteSheet","gameObject","frameAnimation","scene"].forEach(function(e){toDataSource(Models[capitalize(e)],resourceSet[e],DataSource[e+"List"])}),resourceSet=null;