
<div
        app-context-menu="ctxScene"
        class="gameSceneWrapper"
        >
    <div
            ng-show="uiHelper.window=='sceneWindow'"
            class="gameScene relative"
            ng-controller="sceneCtrl"
            app-key-press="onKeyPress($event)"
            app-droppable="gameObjectFromLeftPanel,gameObjectFromSelf"
            app-on-dropped="onGameObjectDropped($object,$draggable,$event)"
            ng-style="{
                width:  editData.gameProps.width+'px',
                height: editData.gameProps.height+'px',
            }">

        <div ng-include src="'partials/centralBlock/tileMap.html'"></div>

        <div ng-repeat="item in editData.currLayerInEdit._gameObjects.rs">

            <div
                    ng-if="!item.subType"
                    app-draggable="gameObjectFromSelf"
                    app-context-menu="ctxGameObject"
                    ng-model="item"

                    ng-click="editData.currSceneGameObjectInEdit=item"
                    ng-style="utils.merge(
                            utils.getGameObjectCss(item),
                            {
                                position:'absolute',
                                left:item.pos.x+'px',
                                top: item.pos.y+'px'
                            }
                    )"
                    ng-class="{active:item==editData.currSceneGameObjectInEdit}"
                    >
            </div>

            <div
                    ng-if="item.subType=='textField'"
                    app-draggable="gameObjectFromSelf"
                    app-context-menu="ctxGameObject"
                    ng-model="item"
                    ng-click="editData.currSceneGameObjectInEdit=item"
                    ng-style="utils.merge(
                            utils.getGameObjectCss(item),
                            {
                                position:'absolute',
                                left:item.pos.x+'px',
                                top: item.pos.y+'px',
                                backgroundColor:'rgb(0,222,0.1)',
                                height:item.height+'px',
                                width:item.width?item.width+'px':'10px',
                                backgroundColor:item.width?'':'#ddd',
                                backgroundImage:'none'
                            }
                    )"
                    ng-class="{active:item==editData.currSceneGameObjectInEdit}"
                    >

                <div style="position: absolute;left:0;top:0;z-index:10">
                    <span
                            ng-style="{
                            left:item.pos.x+'px',
                            top: item.pos.y+'px',
                            display:ch=='\n'?'block':'inline-block',
                            width:item._font.fontContext.symbols[ch].width+'px',
                            height:item._font.fontContext.symbols[ch].height+'px',
                            backgroundImage:'url('+editData.projectName+'/'+item._font.resourcePath+')',
                            backgroundRepeat:     'no-repeat',
                            backgroundPositionX: -item._font.fontContext.symbols[ch].x+'px',
                            backgroundPositionY: -item._font.fontContext.symbols[ch].y+'px'
                        }"
                            ng-repeat="ch in item._chars track by $index">
                        </span>
                </div>

            </div>
        </div>
    </div>
</div>

<div ng-if="uiHelper.window=='debugRunWindow'" class="gameSceneWrapper withPaddingLeft">
    <iframe
            width="{{editData.gameProps.width}}"
            height="{{editData.gameProps.height}}"
            src="{{editData.debugFrameUrl}}"
            frameborder="0" scrolling="no"
            ></iframe>
</div>

<div ng-if="uiHelper.window=='scriptWindow'" class="gameSceneWrapper withPaddingLeft height100 noOverFlow relative">
    <iframe
            id="scriptEditor"
            style="position:absolute;width:100%;height:100%;left:0;top:0;bottom:0;right:0"
            src="{{editData.scriptEditorUrl}}"
            frameborder="0" scrolling="no"
            ></iframe>
</div>